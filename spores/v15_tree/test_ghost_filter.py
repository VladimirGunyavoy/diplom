#!/usr/bin/env python3
"""
–¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏–∑—Ä–∞—á–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤ ZoomManager.
"""

import sys
import os

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –∫ src –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª–µ–π
sys.path.append(os.path.join(os.path.dirname(__file__), 'src'))

def test_ghost_filter():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø—Ä–∏–∑—Ä–∞—á–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤."""
    print("üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏–∑—Ä–∞—á–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤...")
    
    try:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        zoom_manager_path = 'src/managers/zoom_manager.py'
        if not os.path.exists(zoom_manager_path):
            print(f"   ‚ùå –§–∞–π–ª {zoom_manager_path} –Ω–µ –Ω–∞–π–¥–µ–Ω")
            return False
        
        print(f"   ‚úì –§–∞–π–ª {zoom_manager_path} –Ω–∞–π–¥–µ–Ω")
        
        # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∫–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
        with open(zoom_manager_path, 'r', encoding='utf-8') as f:
            content = f.read()
        
        print("   ‚úì –§–∞–π–ª –ø—Ä–æ—á–∏—Ç–∞–Ω —É—Å–ø–µ—à–Ω–æ")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã
        if 'def show_all_objects_with_ghosts(self) -> None:' in content:
            print("   ‚úì –ú–µ—Ç–æ–¥ show_all_objects_with_ghosts –¥–æ–±–∞–≤–ª–µ–Ω")
        else:
            print("   ‚ùå –ú–µ—Ç–æ–¥ show_all_objects_with_ghosts –Ω–µ –Ω–∞–π–¥–µ–Ω")
            return False
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏–∫—É —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏–∑—Ä–∞–∫–æ–≤
        if '–§–∏–ª—å—Ç—Ä—É–µ–º –ø—Ä–∏–∑—Ä–∞—á–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã' in content:
            print("   ‚úì –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏–∑—Ä–∞—á–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞")
        else:
            print("   ‚ùå –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏–∑—Ä–∞—á–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞")
            return False
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –ø—Ä–∏–∑—Ä–∞—á–Ω–æ—Å—Ç—å
        if 'getattr(obj, \'is_ghost\', False)' in content:
            print("   ‚úì –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–∞ is_ghost —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞")
        else:
            print("   ‚ùå –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–∞ is_ghost –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞")
            return False
        
        if '\'ghost\' in name.lower()' in content:
            print("   ‚úì –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–µ–Ω–∏ –Ω–∞ ghost —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞")
        else:
            print("   ‚ùå –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–µ–Ω–∏ –Ω–∞ ghost –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞")
            return False
        
        if 'obj.color.a < 0.8' in content:
            print("   ‚úì –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞")
        else:
            print("   ‚ùå –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞")
            return False
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –ø—Ä–∏–∑—Ä–∞–∫–∞–º
        if '–ü—Ä–∏–∑—Ä–∞—á–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤:' in content:
            print("   ‚úì –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–∏–∑—Ä–∞–∫–∞–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞")
        else:
            print("   ‚ùå –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–∏–∑—Ä–∞–∫–∞–º –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞")
            return False
        
        print("‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏–∑—Ä–∞–∫–æ–≤ –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ!")
        return True
        
    except Exception as e:
        print(f"   ‚ùå –û—à–∏–±–∫–∞: {e}")
        import traceback
        traceback.print_exc()
        return False

if __name__ == "__main__":
    success = test_ghost_filter()
    if success:
        print("\nüéâ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏–∑—Ä–∞—á–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!")
        print("\nüìã –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ:")
        print("   ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏–∑—Ä–∞–∫–æ–≤ –≤ print_all_objects")
        print("   ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–∞ is_ghost")
        print("   ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–µ–Ω–∏ –Ω–∞ 'ghost'")
        print("   ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ (alpha < 0.8)")
        print("   ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø—Ä–∏–∑—Ä–∞–∫–æ–≤")
        print("   ‚úÖ –ú–µ—Ç–æ–¥ show_all_objects_with_ghosts –¥–ª—è –ø–æ–ª–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏")
        print("\nüîç –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞:")
        print("   üîç ZoomManager: –û–±—ä–µ–∫—Ç—ã –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ")
        print("   üìä –í—Å–µ–≥–æ –æ–±—ä–µ–∫—Ç–æ–≤: 3")
        print("   üëª –ü—Ä–∏–∑—Ä–∞—á–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤: 2 (—Å–∫—Ä—ã—Ç—ã –∏–∑ –≤—ã–≤–æ–¥–∞)")
        print("   üìã –¢–∏–ø—ã –æ–±—ä–µ–∫—Ç–æ–≤ (–Ω–µ-–ø—Ä–∏–∑—Ä–∞–∫–∏):")
        print("      ‚Ä¢ Spore: 1 —à—Ç.")
        print("        - test_spore_1")
        print("   üÜï –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã (–Ω–µ-–ø—Ä–∏–∑—Ä–∞–∫–∏):")
        print("      ‚Ä¢ test_spore_1 (Spore, ID: 1)")
    else:
        print("\nüí• –¢–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å —Å –æ—à–∏–±–∫–∞–º–∏!")
