# –ú–µ—Ç–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: L-BFGS-B –∏ Differential Evolution

## –í–≤–µ–¥–µ–Ω–∏–µ

–í –∑–∞–¥–∞—á–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ø–æ—Ä–∞–º–∏ –º—ã —Ä–µ—à–∞–µ–º –∑–∞–¥–∞—á—É –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

$$\min_{u \in [-1,1], \, dt \in [0.001, 0.1]} f(u, dt) = \|x_{next} - x_{goal}\|^2$$

–≥–¥–µ –¥–∏–Ω–∞–º–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –ª–∏–Ω–µ–∞—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é:

$$x_{next} = (I + A_{cont} \cdot dt) \cdot x_{current} + B_{cont} \cdot dt \cdot u$$

–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–≤–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ —Ä–∞–∑–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–∞ –∫ —Ä–µ—à–µ–Ω–∏—é —ç—Ç–æ–π –∑–∞–¥–∞—á–∏.

---

## 1. L-BFGS-B (Limited-memory Broyden-Fletcher-Goldfarb-Shanno with Box constraints)

### üéØ –¢–∏–ø –º–µ—Ç–æ–¥–∞
**–ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π (–ª–æ–∫–∞–ª—å–Ω—ã–π) –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–∏.

### üìê Mathematical Foundation

–ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É –≤ BFGS –∏ L-BFGS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ì–µ—Å—Å–∏–∞–Ω–∞, –¥–∞–≤–∞–π—Ç–µ –≤–µ—Ä–Ω–µ–º—Å—è –∫ –∏—Å—Ç–æ–∫–∞–º ‚Äî –º–µ—Ç–æ–¥—É –ù—å—é—Ç–æ–Ω–∞.

#### 1. –í—ã–≤–æ–¥ –∏—Ç–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Ñ–æ—Ä–º—É–ª—ã –ù—å—é—Ç–æ–Ω–∞

–ú—ã —Ö–æ—Ç–∏–º –Ω–∞–π—Ç–∏ –º–∏–Ω–∏–º—É–º —Ñ—É–Ω–∫—Ü–∏–∏ $f(x)$. –î–ª—è —ç—Ç–æ–≥–æ —Ä–∞–∑–ª–æ–∂–∏–º –µ—ë –≤ —Ä—è–¥ –¢–µ–π–ª–æ—Ä–∞ –≤ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç–∏ —Ç–µ–∫—É—â–µ–π —Ç–æ—á–∫–∏ $x_k$ –¥–æ –≤—Ç–æ—Ä–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞:

$$f(x) \approx f(x_k) + \nabla f(x_k)^T (x - x_k) + \frac{1}{2} (x - x_k)^T \nabla^2 f(x_k) (x - x_k)$$

–ó–¥–µ—Å—å $\nabla f(x_k)$ ‚Äî —ç—Ç–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç (–≤–µ–∫—Ç–æ—Ä –ø–µ—Ä–≤—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö), –∞ $\nabla^2 f(x_k)$ ‚Äî —ç—Ç–æ –º–∞—Ç—Ä–∏—Ü–∞ –ì–µ—Å—Å–µ (–º–∞—Ç—Ä–∏—Ü–∞ –≤—Ç–æ—Ä—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö) –≤ —Ç–æ—á–∫–µ $x_k$.

–î–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–æ—á–∫–∏ –º–∏–Ω–∏–º—É–º–∞ $x$ —ç—Ç–æ–≥–æ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–≥–æ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è, –º—ã –±–µ—Ä–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é –ø–æ $x$ –∏ –ø—Ä–∏—Ä–∞–≤–Ω–∏–≤–∞–µ–º –µ—ë –∫ –Ω—É–ª—é:

$$\nabla_x f(x) \approx \nabla f(x_k) + \nabla^2 f(x_k) (x - x_k) = 0$$

–û—Ç—Å—é–¥–∞ –º—ã –º–æ–∂–µ–º –≤—ã—Ä–∞–∑–∏—Ç—å —à–∞–≥ $(x - x_k)$, –∫–æ—Ç–æ—Ä—ã–π –≤–µ–¥–µ—Ç –∫ –º–∏–Ω–∏–º—É–º—É. –û–±–æ–∑–Ω–∞—á–∏–≤ —Å–ª–µ–¥—É—é—â—É—é —Ç–æ—á–∫—É –∫–∞–∫ $x_{k+1}$, –ø–æ–ª—É—á–∞–µ–º:

$$\nabla^2 f(x_k) (x_{k+1} - x_k) = - \nabla f(x_k)$$

$$x_{k+1} - x_k = -[\nabla^2 f(x_k)]^{-1} \nabla f(x_k)$$

–≠—Ç–æ –∏ –µ—Å—Ç—å –∏—Ç–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞. –®–∞–≥ –ø–æ–∏—Å–∫–∞ $p_k = x_{k+1} - x_k$ —Ä–∞–≤–µ–Ω –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é –æ–±—Ä–∞—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –ì–µ—Å—Å–µ –Ω–∞ –∞–Ω—Ç–∏-–≥—Ä–∞–¥–∏–µ–Ω—Ç.

#### 2. –ü—Ä–æ–±–ª–µ–º–∞ –∏ —Ä–µ—à–µ–Ω–∏–µ: –ö–≤–∞–∑–∏-–ù—å—é—Ç–æ–Ω–æ–≤—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã

–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞ ‚Äî –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å. –ù–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:
1.  **–í—ã—á–∏—Å–ª–∏—Ç—å –º–∞—Ç—Ä–∏—Ü—É –ì–µ—Å—Å–µ** $\nabla^2 f(x_k)$ —Ä–∞–∑–º–µ—Ä–∞ $n \times n$, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏—è $n(n+1)/2$ –≤—Ç–æ—Ä—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö.
2.  **–û–±—Ä–∞—Ç–∏—Ç—å –º–∞—Ç—Ä–∏—Ü—É –ì–µ—Å—Å–µ**, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ $O(n^3)$.

–î–ª—è –∑–∞–¥–∞—á —Å –±–æ–ª—å—à–∏–º —á–∏—Å–ª–æ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (–±–æ–ª—å—à–∏–º $n$) —ç—Ç–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã–º.

**–ö–≤–∞–∑–∏-–ù—å—é—Ç–æ–Ω–æ–≤—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã**, —Ç–∞–∫–∏–µ –∫–∞–∫ BFGS, –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ì–µ—Å—Å–∏–∞–Ω–∞ –∏ –µ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è, –æ–Ω–∏ —Å—Ç—Ä–æ—è—Ç –∏ –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ –æ–±–Ω–æ–≤–ª—è—é—Ç **–∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ì–µ—Å—Å–∏–∞–Ω–∞**, –∫–æ—Ç–æ—Ä—É—é –º—ã –æ–±–æ–∑–Ω–∞—á–∏–º –∫–∞–∫ $H_k$.

$$H_k \approx [\nabla^2 f(x_k)]^{-1}$$

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∏—Ç–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤–∏–¥:

$$x_{k+1} = x_k - \alpha_k H_k \nabla f(x_k)$$

–≥–¥–µ $\alpha_k$ ‚Äî —ç—Ç–æ –¥–ª–∏–Ω–∞ —à–∞–≥–∞, –∫–æ—Ç–æ—Ä–∞—è –æ–±—ã—á–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –ª–∏–Ω–µ–π–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ (line search).

#### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ì–µ—Å—Å–∏–∞–Ω–∞ –≤ BFGS

–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è BFGS ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã $H_k$ –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞—Ö, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—è —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º–æ–º—É **—Å–µ–∫–∞–Ω—Ç–Ω–æ–º—É —É—Å–ª–æ–≤–∏—é**. –§–æ—Ä–º—É–ª–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ *–æ–±—Ä–∞—Ç–Ω–æ–≥–æ* –ì–µ—Å—Å–∏–∞–Ω–∞ $H_k$ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:

$$H_{k+1} = \left(I - \frac{s_k y_k^T}{y_k^T s_k}\right) H_k \left(I - \frac{y_k s_k^T}{y_k^T s_k}\right) + \frac{s_k s_k^T}{y_k^T s_k}$$

–≥–¥–µ, –∫–∞–∫ –∏ —Ä–∞–Ω–µ–µ, $s_k = x_{k+1} - x_k$ –∏ $y_k = \nabla f(x_{k+1}) - \nabla f(x_k)$.

–≠—Ç–∞ —Ñ–æ—Ä–º—É–ª–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—é, –Ω–µ —Ç—Ä–µ–±—É—è –Ω–∏–∫–∞–∫–∏—Ö –≤—Ç–æ—Ä—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö –∏–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü.

#### 4. –û—Ç BFGS –∫ L-BFGS (Limited memory)

–ú–µ—Ç–æ–¥ BFGS –≤—Å—ë –µ—â—ë —Ç—Ä–µ–±—É–µ—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–ª–æ—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã $H_k$ —Ä–∞–∑–º–µ—Ä–∞ $n \times n$. –î–ª—è –±–æ–ª—å—à–∏—Ö $n$ —ç—Ç–æ –≤—Å—ë –µ—â—ë –¥–æ—Ä–æ–≥–æ –ø–æ –ø–∞–º—è—Ç–∏. **L-BFGS (Limited-memory BFGS)** —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É.

–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã —Ö—Ä–∞–Ω–∏—Ç—å –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –≤—Å—é –º–∞—Ç—Ä–∏—Ü—É $H_k$, L-BFGS —Ö—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ $\{s_i, y_i\}$ (–æ–±—ã—á–Ω–æ –æ—Ç 5 –¥–æ 20). –ö–æ–≥–¥–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—ã—á–∏—Å–ª–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞ $d_k = -H_k \nabla f(x_k)$, L-BFGS –¥–µ–ª–∞–µ—Ç —ç—Ç–æ "–Ω–∞ –ª–µ—Ç—É" —Å –ø–æ–º–æ—â—å—é **–¥–≤—É—Ö–ø–µ—Ç–ª–µ–≤–æ–π —Ä–µ–∫—É—Ä—Å–∏–∏** (two-loop recursion), –∏—Å–ø–æ–ª—å–∑—É—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∫–≤–∞–∑–∏-–Ω—å—é—Ç–æ–Ω–æ–≤—Å–∫–æ–≥–æ –º–µ—Ç–æ–¥–∞ –ø—Ä–∏ –∑–∞—Ç—Ä–∞—Ç–∞—Ö –ø–∞–º—è—Ç–∏ –≤—Å–µ–≥–æ $O(m \cdot n)$, –≥–¥–µ $m$ ‚Äî —á–∏—Å–ª–æ —Ö—Ä–∞–Ω–∏–º—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –Ω–∞–ª–∏—á–∏–µ **–∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ì–µ—Å—Å–∏–∞–Ω–∞** ‚Äî —ç—Ç–æ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∏–¥–µ—è, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–µ—Ç–æ–¥—É L-BFGS –±—ã—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –∏ –±—ã—Å—Ç—Ä—ã–º, —Å–æ—á–µ—Ç–∞—è –≤ —Å–µ–±–µ —Å–∫–æ—Ä–æ—Å—Ç—å —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –±–ª–∏–∑–∫—É—é –∫ –º–µ—Ç–æ–¥—É –ù—å—é—Ç–æ–Ω–∞, –∏ –Ω–∏–∑–∫–∏–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã.

#### Box constraints (–≥—Ä–∞–Ω–∏—Ü—ã)
–î–ª—è —É—á—ë—Ç–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π $u \in [-1,1], \, dt \in [0.001,0.1]$ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ–µ–∫—Ü–∏—è:

$$x_{k+1} = P_{\mathcal{B}}(x_k - \alpha_k d_k)$$

–≥–¥–µ $P_{\mathcal{B}}$ - –ø—Ä–æ–µ–∫—Ü–∏—è –Ω–∞ –¥–æ–ø—É—Å—Ç–∏–º–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ $\mathcal{B} = [-1,1] \times [0.001,0.1]$:

$$P_{\mathcal{B}}(x) = \begin{bmatrix} \max(-1, \min(1, x_1)) \\ \max(0.001, \min(0.1, x_2)) \end{bmatrix}$$

### ‚öôÔ∏è –ê–ª–≥–æ—Ä–∏—Ç–º L-BFGS-B

```python
def LBFGS_B(f, x0, bounds, m=10):
    x = x0
    grad = compute_gradient(f, x)
    H0 = identity_matrix()  # –ù–∞—á–∞–ª—å–Ω–∞—è –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è
    
    memory = []  # –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è (s_k, y_k)
    
    for k in range(max_iterations):
        # 1. –í—ã—á–∏—Å–ª—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞
        if len(memory) == 0:
            d = -grad  # –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫
        else:
            d = -two_loop_recursion(grad, memory, H0)
        
        # 2. –ü–æ–∏—Å–∫ —à–∞–≥–∞ —Å —É—á–µ—Ç–æ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
        alpha = line_search_with_bounds(f, x, d, bounds)
        
        # 3. –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é (—Å –ø—Ä–æ–µ–∫—Ü–∏–µ–π –Ω–∞ –≥—Ä–∞–Ω–∏—Ü—ã)
        x_new = project_to_bounds(x + alpha * d, bounds)
        
        # 4. –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞–º—è—Ç—å
        s = x_new - x
        y = compute_gradient(f, x_new) - grad
        
        if len(memory) >= m:
            memory.pop(0)  # –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –ø–∞—Ä—É
        memory.append((s, y))
        
        x = x_new
        grad = compute_gradient(f, x_new)
        
        if convergence_check(grad):
            break
    
    return x
```

### üîç Two-loop recursion

–ö–ª—é—á–µ–≤–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º L-BFGS –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞:

```python
def two_loop_recursion(grad, memory, H0):
    q = grad.copy()
    alphas = []
    
    # –ü–µ—Ä–≤—ã–π —Ü–∏–∫–ª (–Ω–∞–∑–∞–¥ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏)
    for s, y in reversed(memory):
        rho = 1.0 / (y.T @ s)
        alpha = rho * (s.T @ q)
        q = q - alpha * y
        alphas.append(alpha)
    
    # –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É
    r = H0 @ q
    
    # –í—Ç–æ—Ä–æ–π —Ü–∏–∫–ª (–≤–ø–µ—Ä–µ–¥ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏) 
    for i, (s, y) in enumerate(memory):
        rho = 1.0 / (y.T @ s)
        beta = rho * (y.T @ r)
        r = r + (alphas[-(i+1)] - beta) * s
    
    return r
```

### ‚ö° –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ L-BFGS-B:
- **–ë—ã—Å—Ç—Ä–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å**: O(n) –ø–∞–º—è—Ç–∏ –≤–º–µ—Å—Ç–æ O(n¬≤)
- **–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å**: –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤–±–ª–∏–∑–∏ –º–∏–Ω–∏–º—É–º–∞
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ box constraints
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: –º–∞–ª–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–∏

### ‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:
- **–õ–æ–∫–∞–ª—å–Ω–æ—Å—Ç—å**: –∑–∞—Å—Ç—Ä–µ–≤–∞–µ—Ç –≤ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –º–∏–Ω–∏–º—É–º–∞—Ö
- **–ì—Ä–∞–¥–∏–µ–Ω—Ç—ã**: —Ç—Ä–µ–±—É–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö (—á–∏—Å–ª–µ–Ω–Ω–æ –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ)
- **–ù–∞—á–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞**: —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç x‚ÇÄ

---

## 2. Differential Evolution (DE)

### üéØ –¢–∏–ø –º–µ—Ç–æ–¥–∞
**–ü–æ–ø—É–ª—è—Ü–∏–æ–Ω–Ω—ã–π —ç–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–π (–≥–ª–æ–±–∞–ª—å–Ω—ã–π) –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä** - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã.

### üß¨ –ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –º–æ—Ç–∏–≤–∞—Ü–∏—è

–ú–µ—Ç–æ–¥ –∏–º–∏—Ç–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —ç–≤–æ–ª—é—Ü–∏–∏:
- **–ü–æ–ø—É–ª—è—Ü–∏—è** - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π
- **–ú—É—Ç–∞—Ü–∏—è** - —Å–ª—É—á–∞–π–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **–°–∫—Ä–µ—â–∏–≤–∞–Ω–∏–µ** - –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π  
- **–°–µ–ª–µ–∫—Ü–∏—è** - –≤—ã–∂–∏–≤–∞–Ω–∏–µ –ª—É—á—à–∏—Ö

### üìä –ê–ª–≥–æ—Ä–∏—Ç–º Differential Evolution

```python
def differential_evolution(f, bounds, popsize=15, F=0.8, CR=0.7):
    # 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ø—É–ª—è—Ü–∏–∏
    D = len(bounds)  # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∑–∞–¥–∞—á–∏
    NP = popsize * D  # –†–∞–∑–º–µ—Ä –ø–æ–ø—É–ª—è—Ü–∏–∏
    
    # –°–ª—É—á–∞–π–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–Ω—É—Ç—Ä–∏ –≥—Ä–∞–Ω–∏—Ü
    pop = []
    for i in range(NP):
        individual = []
        for j, (lower, upper) in enumerate(bounds):
            individual.append(random.uniform(lower, upper))
        pop.append(individual)
    
    # –í—ã—á–∏—Å–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏
    fitness = [f(x) for x in pop]
    
    for generation in range(max_generations):
        for i in range(NP):
            # 2. –ú–£–¢–ê–¶–ò–Ø: —Å–æ–∑–¥–∞–µ–º –º—É—Ç–∞–Ω—Ç–Ω—ã–π –≤–µ–∫—Ç–æ—Ä
            # –í—ã–±–∏—Ä–∞–µ–º 3 —Å–ª—É—á–∞–π–Ω—ã—Ö –∏–Ω–¥–∏–≤–∏–¥–∞ (–Ω–µ i)
            candidates = list(range(NP))
            candidates.remove(i)
            a, b, c = random.sample(candidates, 3)
            
            # –ú—É—Ç–∞–Ω—Ç–Ω—ã–π –≤–µ–∫—Ç–æ—Ä: v = xa + F*(xb - xc)
            mutant = []
            for j in range(D):
                v_j = pop[a][j] + F * (pop[b][j] - pop[c][j])
                # –û–±—Ä–µ–∑–∞–µ–º –ø–æ –≥—Ä–∞–Ω–∏—Ü–∞–º
                lower, upper = bounds[j]
                v_j = max(lower, min(upper, v_j))
                mutant.append(v_j)
            
            # 3. –°–ö–†–ï–©–ò–í–ê–ù–ò–ï: —Å–æ–∑–¥–∞–µ–º –ø—Ä–æ–±–Ω—ã–π –≤–µ–∫—Ç–æ—Ä
            trial = []
            for j in range(D):
                if random.random() < CR or j == random.randint(0, D-1):
                    trial.append(mutant[j])  # –ë–µ—Ä–µ–º –∏–∑ –º—É—Ç–∞–Ω—Ç–∞
                else:
                    trial.append(pop[i][j])  # –ë–µ—Ä–µ–º –∏–∑ —Ä–æ–¥–∏—Ç–µ–ª—è
            
            # 4. –°–ï–õ–ï–ö–¶–ò–Ø: –≤—ã–±–∏—Ä–∞–µ–º –ª—É—á—à–µ–≥–æ
            trial_fitness = f(trial)
            if trial_fitness < fitness[i]:
                pop[i] = trial
                fitness[i] = trial_fitness
    
    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ª—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ
    best_idx = fitness.index(min(fitness))
    return pop[best_idx], fitness[best_idx]
```

### üîß –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

#### –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –º—É—Ç–∞—Ü–∏–∏ $F \in [0, 2]$
- **$F = 0$**: –Ω–µ—Ç –º—É—Ç–∞—Ü–∏–∏, –ø–æ–ø—É–ª—è—Ü–∏—è –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è
- **$F = 1$**: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å
- **$F > 1$**: –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –º—É—Ç–∞—Ü–∏—è, –±–æ–ª—å—à–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

#### –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–∫—Ä–µ—â–∏–≤–∞–Ω–∏—è $CR \in [0, 1]$ 
- **$CR = 0$**: –±–µ—Ä—ë–º —Ç–æ–ª—å–∫–æ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –≥–µ–Ω—ã
- **$CR = 1$**: –±–µ—Ä—ë–º —Ç–æ–ª—å–∫–æ –º—É—Ç–∞–Ω—Ç–Ω—ã–µ –≥–µ–Ω—ã
- **$CR \approx 0.7$**: –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∑–∞–¥–∞—á

#### –†–∞–∑–º–µ—Ä –ø–æ–ø—É–ª—è—Ü–∏–∏ $NP$
- **–û–±—ã—á–Ω–æ**: $NP = 10D$ –¥–æ $20D$, –≥–¥–µ $D$ - —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∑–∞–¥–∞—á–∏
- **–ú–∞–ª–µ–Ω—å–∫–æ–µ $NP$**: –±—ã—Å—Ç—Ä–µ–µ, –Ω–æ –º–æ–∂–µ—Ç –Ω–µ –Ω–∞–π—Ç–∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º
- **–ë–æ–ª—å—à–æ–µ $NP$**: –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –Ω–∞–¥—ë–∂–Ω–µ–µ

### üåü –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –º—É—Ç–∞—Ü–∏–∏:

–í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **DE/rand/1**:

$$v_i = x_a + F \cdot (x_b - x_c)$$

–î—Ä—É–≥–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:
- **DE/best/1**: $v_i = x_{best} + F \cdot (x_a - x_b)$
- **DE/rand/2**: $v_i = x_a + F \cdot (x_b - x_c) + F \cdot (x_d - x_e)$
- **DE/current-to-best/1**: $v_i = x_i + F \cdot (x_{best} - x_i) + F \cdot (x_a - x_b)$

–≥–¥–µ $x_a, x_b, x_c, x_d, x_e$ - —Å–ª—É—á–∞–π–Ω–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∏–Ω–¥–∏–≤–∏–¥—ã –∏–∑ –ø–æ–ø—É–ª—è—Ü–∏–∏.

### ‚ö° –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ DE:
- **–ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –Ω–µ –∑–∞—Å—Ç—Ä–µ–≤–∞–µ—Ç –≤ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –º–∏–Ω–∏–º—É–º–∞—Ö
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞**: –º–∞–ª–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- **–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**: —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–µ–≥–ª–∞–¥–∫–∏–º–∏, –º–Ω–æ–≥–æ–º–æ–¥–∞–ª—å–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏
- **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º**: –ª–µ–≥–∫–æ —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–µ—Ç—Å—è
- **–ù–µ –Ω—É–∂–Ω—ã –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã**: —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏

### ‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:
- **–°–∫–æ—Ä–æ—Å—Ç—å**: –º–µ–¥–ª–µ–Ω–Ω–µ–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
- **–ü–∞–º—è—Ç—å**: —Ç—Ä–µ–±—É–µ—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ–π –ø–æ–ø—É–ª—è—Ü–∏–∏
- **–¢–æ—á–Ω–æ—Å—Ç—å**: –º–æ–∂–µ—Ç –Ω–µ –¥–æ—Å—Ç–∏—á—å –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å F, CR, NP

---

## üîÑ –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥

–í –Ω–∞—à–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–≥–∏–±—Ä–∏–¥–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è**:

```python
# 1. Differential Evolution –∏—â–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º
result_de = differential_evolution(f, bounds, polish=True)

# 2. L-BFGS-B "–ø–æ–ª–∏—Ä—É–µ—Ç" —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ª–æ–∫–∞–ª—å–Ω–æ  
result_final = minimize(f, result_de.x, method='L-BFGS-B', bounds=bounds)
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –≥–∏–±—Ä–∏–¥–∞:
- **DE** –Ω–∞—Ö–æ–¥–∏—Ç –æ–±–ª–∞—Å—Ç—å –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –º–∏–Ω–∏–º—É–º–∞
- **L-BFGS-B** —É—Ç–æ—á–Ω—è–µ—Ç —Ä–µ—à–µ–Ω–∏–µ —Å –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é
- –ü–æ–ª—É—á–∞–µ–º –ª—É—á—à–µ–µ –∏–∑ –æ–±–æ–∏—Ö –º–∏—Ä–æ–≤

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤

| –ö—Ä–∏—Ç–µ—Ä–∏–π | L-BFGS-B | Differential Evolution |
|----------|----------|----------------------|
| **–¢–∏–ø** | –õ–æ–∫–∞–ª—å–Ω—ã–π/–ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π | –ì–ª–æ–±–∞–ª—å–Ω—ã–π/–ü–æ–ø—É–ª—è—Ü–∏–æ–Ω–Ω—ã–π |
| **–°–∫–æ—Ä–æ—Å—Ç—å** | üü¢ –û—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–π | üü° –°—Ä–µ–¥–Ω–∏–π |
| **–¢–æ—á–Ω–æ—Å—Ç—å** | üü¢ –í—ã—Å–æ–∫–∞—è | üü° –°—Ä–µ–¥–Ω—è—è |
| **–ì–ª–æ–±–∞–ª—å–Ω–æ—Å—Ç—å** | üî¥ –õ–æ–∫–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º | üü¢ –ì–ª–æ–±–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º |
| **–ì—Ä–∞–¥–∏–µ–Ω—Ç—ã** | üî¥ –ù—É–∂–Ω—ã | üü¢ –ù–µ –Ω—É–∂–Ω—ã |
| **–ù–∞—Å—Ç—Ä–æ–π–∫–∞** | üü¢ –ú–∞–ª–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ | üü° –°—Ä–µ–¥–Ω–µ |
| **–ü–∞–º—è—Ç—å** | üü¢ $O(mD)$ –≥–¥–µ $m \leq 20$ | üü° $O(NP \times D)$ |
| **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º** | üî¥ –°–ª–æ–∂–Ω–æ | üü¢ –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ |

---

## üéØ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ –∑–∞–¥–∞—á–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ù–∞—à–∞ –∑–∞–¥–∞—á–∞:

$$\min_{u, dt} f(u, dt) = \|x_{next}(u, dt) - x_{goal}\|^2$$

–≥–¥–µ –¥–∏–Ω–∞–º–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã:

$$x_{next} = \underbrace{(I + A_{continuous} \cdot dt)}_{\text{–º–∞—Ç—Ä–∏—Ü–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞}} \cdot x_{current} + \underbrace{B_{continuous} \cdot dt \cdot u}_{\text{—É–ø—Ä–∞–≤–ª—è—é—â–µ–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ}}$$

–ó–¥–µ—Å—å:
- $A_{continuous} \in \mathbb{R}^{2 \times 2}$ - –º–∞—Ç—Ä–∏—Ü–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (–ª–∏–Ω–µ–∞—Ä–∏–∑–∞—Ü–∏—è)
- $B_{continuous} \in \mathbb{R}^{2 \times 1}$ - –º–∞—Ç—Ä–∏—Ü–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- $x_{current}, x_{goal} \in \mathbb{R}^2$ - —Ç–µ–∫—É—â–µ–µ –∏ —Ü–µ–ª–µ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- $u \in [-1, 1]$ - —Å–∫–∞–ª—è—Ä–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- $dt \in [0.001, 0.1]$ - –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∞–≥ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
1. **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å**: $D = 2$ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ $(u, dt)$ - –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–∏–∑–∫–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å
2. **–ì–ª–∞–¥–∫–æ—Å—Ç—å**: —Ñ—É–Ω–∫—Ü–∏—è $f(u, dt)$ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä—É–µ–º–∞—è –ø–æ –æ–±–µ–∏–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º
3. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –ø—Ä–æ—Å—Ç—ã–µ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è $\mathcal{B} = [-1,1] \times [0.001,0.1]$
4. **–ù–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å**: –±–∏–ª–∏–Ω–µ–π–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç $dt \cdot u$ –≤ –¥–∏–Ω–∞–º–∏–∫–µ —Å–∏—Å—Ç–µ–º—ã
5. **–õ–∏–Ω–µ–∞—Ä–∏–∑–∞—Ü–∏—è**: –º–∞—Ç—Ä–∏—Ü—ã $A_{continuous}(x_{current})$ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –ü–æ—á–µ–º—É –æ–±–∞ –º–µ—Ç–æ–¥–∞ —Ä–∞–±–æ—Ç–∞—é—Ç:
- **L-BFGS-B**: –±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≥–ª–∞–¥–∫–∞—è
- **DE**: –∏—Å—Å–ª–µ–¥—É–µ—Ç –≤—Å—ë –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –Ω–∞—Ö–æ–¥–∏—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º –ø—Ä–∏ multimodality

### –í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞:
- **–ï—Å–ª–∏ —Å–∫–æ—Ä–æ—Å—Ç—å –≤–∞–∂–Ω–∞**: L-BFGS-B
- **–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å**: Differential Evolution  
- **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞**: –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (DE + L-BFGS-B)

---

## üìö –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞ –∏ —Å—Å—ã–ª–∫–∏

1. **L-BFGS-B**: Byrd, R. H., Lu, P., Nocedal, J., & Zhu, C. (1995). "A Limited Memory Algorithm for Bound Constrained Optimization"
2. **Differential Evolution**: Storn, R., & Price, K. (1997). "Differential Evolution ‚Äì A Simple and Efficient Heuristic for global Optimization"
3. **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ**: Scipy documentation, `scipy.optimize`

---

## üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å L-BFGS-B:
- –§—É–Ω–∫—Ü–∏—è –≥–ª–∞–¥–∫–∞—è –∏ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä—É–µ–º–∞—è
- –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∞—è-—Å—Ä–µ–¥–Ω—è—è (< 1000)
- –ï—Å—Ç—å —Ö–æ—Ä–æ—à–µ–µ –Ω–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ
- –ù—É–∂–Ω–∞ –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å
- –í—Ä–µ–º—è –∫—Ä–∏—Ç–∏—á–Ω–æ

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DE:
- –§—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–≥–ª–∞–¥–∫–æ–π, –º–Ω–æ–≥–æ–º–æ–¥–∞–ª—å–Ω–æ–π
- –ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞—Ö
- –ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –º–∏–Ω–∏–º—É–º—ã
- –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∞—è-—Å—Ä–µ–¥–Ω—è—è (< 100)
- –ú–æ–∂–Ω–æ –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

**L-BFGS-B:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `ftol` | $10^{-9}$ | –¢–æ—á–Ω–æ—Å—Ç—å –ø–æ —Ñ—É–Ω–∫—Ü–∏–∏: $\|f_{k+1} - f_k\| < \text{ftol}$ |
| `gtol` | $10^{-5}$ | –¢–æ—á–Ω–æ—Å—Ç—å –ø–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç—É: $\|\nabla f\|_\infty < \text{gtol}$ |
| `maxiter` | $1000$ | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π |
| `maxfun` | $15000$ | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–∏ |

```python
options = {
    'ftol': 1e-9,      # –ö—Ä–∏—Ç–µ—Ä–∏–π —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ —Ñ—É–Ω–∫—Ü–∏–∏
    'gtol': 1e-5,      # –ö—Ä–∏—Ç–µ—Ä–∏–π —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç—É  
    'maxiter': 1000,   # –ú–∞–∫—Å–∏–º—É–º –∏—Ç–µ—Ä–∞—Ü–∏–π
    'disp': True       # –í—ã–≤–æ–¥ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
}
```

**Differential Evolution:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `maxiter` | $100$ | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –ø–æ–∫–æ–ª–µ–Ω–∏–π |
| `popsize` | $15$ | –ú–Ω–æ–∂–∏—Ç–µ–ª—å —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–ø—É–ª—è—Ü–∏–∏: $NP = \text{popsize} \times D$ |
| `atol` | $10^{-6}$ | –ê–±—Å–æ–ª—é—Ç–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å: $f_{best} - f_{worst} < \text{atol}$ |
| `F` | $[0.5, 2.0]$ | –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –º—É—Ç–∞—Ü–∏–∏ (adaptive) |
| `CR` | $0.7$ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–∫—Ä–µ—â–∏–≤–∞–Ω–∏—è |

```python
params = {
    'maxiter': 100,     # –ß–∏—Å–ª–æ –ø–æ–∫–æ–ª–µ–Ω–∏–π —ç–≤–æ–ª—é—Ü–∏–∏
    'popsize': 15,      # –†–∞–∑–º–µ—Ä –ø–æ–ø—É–ª—è—Ü–∏–∏ (√óD)
    'atol': 1e-6,      # –ê–±—Å–æ–ª—é—Ç–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏
    'seed': 42,        # –î–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    'polish': True     # –õ–æ–∫–∞–ª—å–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞ L-BFGS-B
}
```

### üßÆ –û—Ü–µ–Ω–∫–∞ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

–î–ª—è –Ω–∞—à–µ–π –∑–∞–¥–∞—á–∏ —Å $D = 2$ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:

**L-BFGS-B:**
- –í—Ä–µ–º—è –Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—é: $O(mD) \approx O(20 \times 2) = O(40)$ –æ–ø–µ—Ä–∞—Ü–∏–π
- –ß–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π: –æ–±—ã—á–Ω–æ $5-50$ –¥–ª—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –û–±—â–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: $O(200-2000)$ –æ–ø–µ—Ä–∞—Ü–∏–π

**Differential Evolution:**
- –í—Ä–µ–º—è –Ω–∞ –ø–æ–∫–æ–ª–µ–Ω–∏–µ: $O(NP \times D) = O(30 \times 2) = O(60)$ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–∏
- –ß–∏—Å–ª–æ –ø–æ–∫–æ–ª–µ–Ω–∏–π: –æ–±—ã—á–Ω–æ $50-200$ –¥–ª—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏  
- –û–±—â–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: $O(3000-12000)$ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–∏

–ü–æ—Å–∫–æ–ª—å–∫—É –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–º–∏–Ω–∏—Ä—É–µ—Ç, DE –ø—Ä–∏–º–µ—Ä–Ω–æ –≤ $10-50$ —Ä–∞–∑ –º–µ–¥–ª–µ–Ω–Ω–µ–µ L-BFGS-B.

---

## üìã –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑—é–º–µ

### –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏:
$$\begin{aligned}
&\min_{(u, dt) \in \mathcal{D}} \quad f(u, dt) = \|x_{next}(u, dt) - x_{goal}\|^2 \\
&\text{–≥–¥–µ} \quad \mathcal{D} = [-1, 1] \times [0.001, 0.1] \\
&\text{–∏} \quad x_{next} = A_d(dt) \cdot x_{current} + B_d(dt) \cdot u \\
&\text{—Å} \quad A_d(dt) = I + A_c \cdot dt, \quad B_d(dt) = B_c \cdot dt
\end{aligned}$$

### –ú–µ—Ç–æ–¥—ã —Ä–µ—à–µ–Ω–∏—è:
1. **L-BFGS-B**: $x_{k+1} = P_{\mathcal{D}}(x_k - \alpha_k H_k^{-1} \nabla f(x_k))$
2. **Differential Evolution**: $v_i = x_a + F(x_b - x_c)$ ‚Üí —Å–µ–ª–µ–∫—Ü–∏—è –ª—É—á—à–∏—Ö

### –ö–ª—é—á–µ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å**: $D = 2$ (–Ω–∏–∑–∫–∞—è) ‚üπ –æ–±–∞ –º–µ—Ç–æ–¥–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã
- **–ì–ª–∞–¥–∫–æ—Å—Ç—å**: $f \in C^1$ ‚üπ L-BFGS-B —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ  
- **–ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å**: –≤–æ–∑–º–æ–∂–Ω–∞ ‚üπ DE –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–µ–Ω
- **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä**: –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ DE ‚Üí L-BFGS-B

$$\boxed{\text{–í—Ä–µ–º—è: L-BFGS-B} \ll \text{DE, –Ω–æ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å: DE} \geq \text{L-BFGS-B}}$$ 